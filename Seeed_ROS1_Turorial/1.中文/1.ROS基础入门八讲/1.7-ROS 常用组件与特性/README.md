# ROS 常用组件与特性

## ROS 分布式通信

ROS（机器人操作系统）被设计为一个分布式计算环境。这意味着一个运行中的 ROS 系统可以由分布在多台机器上的多个节点组成。根据配置的不同，任何节点可能需要在任何时间与任何其他节点进行通信。

为了实现这一点，ROS 对网络有特定的要求：

1. 所有机器之间的所有端口必须具备完全的双向连通性。
2. 每台机器必须使用一个能被所有其他机器解析的名称来宣告自己。

### 实现步骤

#### 1. 准备工作

在配置 ROS 分布式通信之前，请确保不同的计算机处于同一个网络中。理想情况下，应为每台计算机分配一个静态 IP 地址。如果您使用的是虚拟机，则需要将网络适配器设置更改为“桥接模式 (Bridged Mode)”，以允许它们在同一个网络中进行交互。

#### 2. 修改配置文件

在每台计算机上，您都需要修改 `/etc/hosts` 文件，以包含其他机器的 IP 地址和主机名。

- **在主机 (Host Machine) 上：**

  添加从机 (Slave) 的 IP 地址和主机名。

  ```plaintext
  <从机_IP_地址>    <从机_主机名>
  ```

- **在从机 (Slave Machine) 上：**

  添加主机 (Host) 的 IP 地址和主机名。

  ```plaintext
  <主机_IP_地址>    <主机_主机名>
  ```

更新 `/etc/hosts` 文件后，使用 `ping` 命令测试机器之间是否可以相互通信：

- **检查 IP 地址：** 使用 `ifconfig` 或 `ip addr show`。
- **检查主机名：** 使用 `hostname`。

#### 3. 配置主机的 IP 地址

在主机上，您需要通过在 `~/.bashrc` 文件中添加以下行来配置 IP 地址：

```bash
export ROS_MASTER_URI=http://<主机_IP_地址>:11311
export ROS_HOSTNAME=<主机_IP_地址>
```

这些行将 `ROS_MASTER_URI` 设置为主机的 IP 地址，这会告知 ROS 运行主节点 (`roscore`) 的位置。`ROS_HOSTNAME` 设置了 ROS 将使用的该机器的主机名。

#### 4. 配置从机的 IP 地址

在每台从机上（您可以拥有多台从机），您也需要修改 `~/.bashrc` 文件，添加：

```bash
export ROS_MASTER_URI=http://<主机_IP_地址>:11311
export ROS_HOSTNAME=<从机_IP_地址>
```

此配置将每台从机指向主机的 ROS Master，使它们能够加入 ROS 网络。

### 测试设置

#### 1. 在主机上启动 `roscore`

在主机上，通过运行以下命令启动 ROS Master 节点：

```bash
roscore
```

这一步至关重要，因为 ROS Master 节点负责管理 ROS 网络中不同节点之间的通信。

#### 2. 测试从主机到从机的通信

- **在主机上：** 启动一个订阅者节点。
- **在从机上：** 启动一个发布者节点。

检查节点是否能按预期进行通信。

#### 3. 测试从从机到主机的通信

- **在从机上：** 启动一个订阅者节点。
- **在主机上：** 启动一个发布者节点。

再次验证节点之间的通信是否正常运行。